<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>DVWA-WP | 海生</title><meta name="keywords" content="CTF notes"><meta name="author" content="海生"><meta name="copyright" content="海生"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="DVWA-wpBrute Forcelow因为是简单的题…所以爆破的话首先猜的用户名是admin，然后用brupsuit抓包  然后转发到intruder  载入字典   得到密码 medium对比于low等级，多加了一个sleep(2)，这增加了爆破的响应时间，但是具体操作还是一样的 high 前置知识: isset函数用来检测变量是否设置，并且不是Null 校验了token，每次都需要更新to">
<meta property="og:type" content="article">
<meta property="og:title" content="DVWA-WP">
<meta property="og:url" content="http://example.com/2021/03/09/DVWA%E5%81%9A%E9%A2%98%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="海生">
<meta property="og:description" content="DVWA-wpBrute Forcelow因为是简单的题…所以爆破的话首先猜的用户名是admin，然后用brupsuit抓包  然后转发到intruder  载入字典   得到密码 medium对比于low等级，多加了一个sleep(2)，这增加了爆破的响应时间，但是具体操作还是一样的 high 前置知识: isset函数用来检测变量是否设置，并且不是Null 校验了token，每次都需要更新to">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://ftp.bmp.ovh/imgs/2021/03/cbc47d4371fd43c6.jpg">
<meta property="article:published_time" content="2021-03-09T13:45:05.448Z">
<meta property="article:modified_time" content="2021-05-21T04:45:22.363Z">
<meta property="article:author" content="海生">
<meta property="article:tag" content="CTF notes">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ftp.bmp.ovh/imgs/2021/03/cbc47d4371fd43c6.jpg"><link rel="shortcut icon" href="/img/%E5%9B%BE%E6%A0%87.jpg"><link rel="canonical" href="http://example.com/2021/03/09/DVWA%E5%81%9A%E9%A2%98%E7%AC%94%E8%AE%B0/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  ClickShowText: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-05-21 12:45:22'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'true'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><meta name="generator" content="Hexo 5.2.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/%E5%A4%B4%E5%83%8F1.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">6</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">2</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://ftp.bmp.ovh/imgs/2021/03/cbc47d4371fd43c6.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">海生</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><h1 class="post-title">DVWA-WP</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2021-03-09T13:45:05.448Z" title="Created 2021-03-09 21:45:05">2021-03-09</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2021-05-21T04:45:22.363Z" title="Updated 2021-05-21 12:45:22">2021-05-21</time></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="DVWA-wp"><a href="#DVWA-wp" class="headerlink" title="DVWA-wp"></a>DVWA-wp</h1><h2 id="Brute-Force"><a href="#Brute-Force" class="headerlink" title="Brute Force"></a>Brute Force</h2><h3 id="low"><a href="#low" class="headerlink" title="low"></a>low</h3><p>因为是简单的题…所以爆破的话首先猜的用户名是admin，然后用brupsuit抓包</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519185037.png"></p>
<p>然后转发到intruder</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519185055.png"></p>
<p>载入字典</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519185105.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519185112.png"></p>
<p>得到密码</p>
<h3 id="medium"><a href="#medium" class="headerlink" title="medium"></a>medium</h3><p>对比于low等级，多加了一个sleep(2)，这增加了爆破的响应时间，但是具体操作还是一样的</p>
<h3 id="high"><a href="#high" class="headerlink" title="high"></a>high</h3><p><img src="https://ae01.alicdn.com/kf/Ufba3fd0834224107bab50a19908f444bc.jpg"></p>
<p>前置知识:</p>
<p>isset函数用来检测变量是否设置，并且不是Null</p>
<p>校验了token，每次都需要更新token</p>
<p>stripslashes(str)函数先去除了用户名中出现的反斜杠，然后再使用用户名</p>
<p>mysqli_real_escape_string()函数对\x00、\n、\r、\、’、”、\x1a等进行转义</p>
<p>输入的密码先进行了md5加密</p>
<p>如果密码错了则要等0-3秒后才能再次提交</p>
<p>抓包，发送到intruder</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519190138.png"></p>
<p>选中两处为变量，攻击类型选用pitchfork，它可以使用多组Payload集合，在每个不同的Payload标志位置上遍历所有的Payload。</p>
<p>由于Recursive_Grep模式不支持多线程攻击，所以攻击线程Number of threads设置为1</p>
<p>选择Grep-Extract,提取响应消息中的有效信息</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519185909.png"></p>
<p>设置Grep-Match,当出现Welcome时发出提示</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519185922.png" alt="72"></p>
<p>然后在Redirections中设置为Always，允许重定向</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519190328.png"></p>
<p>Payload set:2设置为Recursive grep，用来载入网页返回的token值，设置结果如下</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519190224.png"></p>
<p>start attack</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519190018.png"></p>
<h2 id="Command-Injection-命令执行漏洞"><a href="#Command-Injection-命令执行漏洞" class="headerlink" title="Command Injection(命令执行漏洞)"></a>Command Injection(命令执行漏洞)</h2><h3 id="low-1"><a href="#low-1" class="headerlink" title="low"></a>low</h3><p>知识点：</p>
<p>A&amp;B是不管A命令是否已经执行，B命令都执行</p>
<p>A&amp;&amp;B是执行完A命令再执行B命令</p>
<p>A|B是A命令的输出，作为B命令的输入</p>
<p>A||B是A命令执行失败，才会执行B命令</p>
<p>先查看源码</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519185156.png"></p>
<p>于是先输入ip地址之后，后台会执行ping命令，那执行了ping命令之后，可以用连接符&amp;&amp;来接下去执行我们想执行的命令，这里尝试了一下</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519185304.png"></p>
<p>可以执行</p>
<h3 id="medium-1"><a href="#medium-1" class="headerlink" title="medium"></a>medium</h3><p>查看源码，得知这次过滤了&amp;&amp;和;</p>
<p>那改用&amp;也可以直接执行命令</p>
<h3 id="high-1"><a href="#high-1" class="headerlink" title="high"></a>high</h3><p>不得不说这题看了很久还是不知道哪里可以利用</p>
<p>后来看了dalao写的wp</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519190430.png"></p>
<p>这里的|后面加了一个空格也就是说只有一个|的情况下是可以绕过的！！！！！！！！！</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519190434.png"></p>
<h2 id="CSRF（跨站点请求伪造）"><a href="#CSRF（跨站点请求伪造）" class="headerlink" title="CSRF（跨站点请求伪造）"></a>CSRF（跨站点请求伪造）</h2><h3 id="low-2"><a href="#low-2" class="headerlink" title="low"></a>low</h3><p>在用户已经登录目标网站之后，诱使用户访问一个攻击页面，利用目标网站对用户的信任，以用户身份在攻击页面对目标网站发起伪造用户操作的行为，达到攻击目的</p>
<p>构建一个html文件</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519185330.png"></p>
<p>这样子点击这个链接的时候，只会看到自己构造的404页面，但是却暗中把密码已经改成了haoye，实现伪造</p>
<p>查了一下，服务器域名是ip，所有无法生成短链接，否则可以自己生成短链接来进行伪造</p>
<h3 id="medium-2"><a href="#medium-2" class="headerlink" title="medium"></a>medium</h3><p>查看源码</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519200106.png">发现多了对http_referer头的核对，想起之前攻防世界做过对referer的伪造，应该是类似的，试着抓包</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519200101.png">然后我原来的url复制到一个新的窗口，进行抓包</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519200046.png">可以看到这是没有Referer的，放包</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519200040.png"></p>
<p>不允许更改密码，那我们只要在发包的时候增加一个referer值就可以了</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519200035.png"></p>
<p>注意这里的referer需要为127.0.0.1</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519200031.png"></p>
<h3 id="high-2"><a href="#high-2" class="headerlink" title="high"></a>high</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">    <span class="keyword">if</span>( <span class="keyword">isset</span>( $_GET[ <span class="string">&#x27;Change&#x27;</span> ] ) ) &#123;     </span><br><span class="line">        <span class="comment">// Check Anti-CSRF token     </span></span><br><span class="line">        checkToken( $_REQUEST[ <span class="string">&#x27;user_token&#x27;</span> ], $_SESSION[ <span class="string">&#x27;session_token&#x27;</span> ], <span class="string">&#x27;index.php&#x27;</span> );      </span><br><span class="line">        <span class="comment">// Get input     </span></span><br><span class="line">   $pass_new  = $_GET[ <span class="string">&#x27;password_new&#x27;</span> ];</span><br><span class="line">   $pass_conf = $_GET[ <span class="string">&#x27;password_conf&#x27;</span> ];      </span><br><span class="line">        <span class="comment">// Do the passwords match?     </span></span><br><span class="line">   <span class="keyword">if</span>( $pass_new == $pass_conf ) &#123;         </span><br><span class="line">       <span class="comment">// They do!         </span></span><br><span class="line">       $pass_new = mysql_real_escape_string( $pass_new );         $pass_new = md5( $pass_new );          </span><br><span class="line">       <span class="comment">// Update the database         </span></span><br><span class="line">       $insert = <span class="string">&quot;UPDATE `users` SET password = &#x27;<span class="subst">$pass_new</span>&#x27; WHERE user = &#x27;&quot;</span> . dvwaCurrentUser() . <span class="string">&quot;&#x27;;&quot;</span>;</span><br><span class="line">       $result = mysql_query( $insert ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">&#x27;&lt;pre&gt;&#x27;</span> . mysql_error() . <span class="string">&#x27;&lt;/pre&gt;&#x27;</span> );</span><br><span class="line">       <span class="comment">// Feedback for the user         </span></span><br><span class="line">       <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;Password Changed.&lt;/pre&gt;&quot;</span>;     &#125;     <span class="keyword">else</span> &#123;         <span class="comment">// Issue with passwords matching         </span></span><br><span class="line">       <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;Passwords did not match.&lt;/pre&gt;&quot;</span>;     &#125;      mysql_close(); &#125;  <span class="comment">// Generate Anti-CSRF token </span></span><br><span class="line">generateSessionToken();  </span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>整理了一下源码，自己大概能看懂的是用户获得了一个token值来作为密匙，更改密码时也要核验这个密匙，然后如果自己要伪造的话，可能需要利用受害者的cookie去获取token。</p>
<h2 id="File-Inclusion-文件包含"><a href="#File-Inclusion-文件包含" class="headerlink" title="File Inclusion(文件包含)"></a>File Inclusion(文件包含)</h2><p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519195400.png" alt="62"></p>
<p>琢磨了一番找不到答案，看了别人的wp，输入不存在的文件之后有出现路径报错，但是这个浏览器没有给报错信息。</p>
<h2 id="File-Upload-文件上传"><a href="#File-Upload-文件上传" class="headerlink" title="File Upload(文件上传)"></a>File Upload(文件上传)</h2><h3 id="low-3"><a href="#low-3" class="headerlink" title="low"></a>low</h3><p>啪的一下，就上传了。。毫无防备</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519185354.png"></p>
<p>试着上传php文件</p>
<p>使用weevely连接</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519190746.png"></p>
<p>注：</p>
<p>生成shell文件：weevely generate 密码 路径 文件名</p>
<p>连接shell： weevely shell文件地址 密码</p>
<p>显示通信过程：curl -v 网址</p>
<h3 id="medium-3"><a href="#medium-3" class="headerlink" title="medium"></a>medium</h3><p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519190756.png"></p>
<p>只接受jpeg或者png格式的文件</p>
<p>加载文件，然后抓包</p>
<p><img src="https://ae01.alicdn.com/kf/U73967036091d4b188e8dbae4b4c9c801R.jpg"></p>
<p>把这里的content-type改为image/png</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519190812.png"></p>
<h3 id="high-3"><a href="#high-3" class="headerlink" title="high"></a>high</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_POST[ <span class="string">&#x27;Upload&#x27;</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Where are we going to be writing to?</span></span><br><span class="line">    $target_path  = DVWA_WEB_PAGE_TO_ROOT . <span class="string">&quot;hackable/uploads/&quot;</span>;</span><br><span class="line">    $target_path .= basename( $_FILES[ <span class="string">&#x27;uploaded&#x27;</span> ][ <span class="string">&#x27;name&#x27;</span> ] );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// File information</span></span><br><span class="line">    $uploaded_name = $_FILES[ <span class="string">&#x27;uploaded&#x27;</span> ][ <span class="string">&#x27;name&#x27;</span> ];</span><br><span class="line">    $uploaded_ext  = substr( $uploaded_name, strrpos( $uploaded_name, <span class="string">&#x27;.&#x27;</span> ) + <span class="number">1</span>);</span><br><span class="line">    $uploaded_size = $_FILES[ <span class="string">&#x27;uploaded&#x27;</span> ][ <span class="string">&#x27;size&#x27;</span> ];</span><br><span class="line">    $uploaded_tmp  = $_FILES[ <span class="string">&#x27;uploaded&#x27;</span> ][ <span class="string">&#x27;tmp_name&#x27;</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Is it an image?</span></span><br><span class="line">    <span class="keyword">if</span>( ( strtolower( $uploaded_ext ) == <span class="string">&quot;jpg&quot;</span> || strtolower( $uploaded_ext ) == <span class="string">&quot;jpeg&quot;</span> || strtolower( $uploaded_ext ) == <span class="string">&quot;png&quot;</span> ) &amp;&amp;</span><br><span class="line">        ( $uploaded_size &lt; <span class="number">100000</span> ) &amp;&amp;</span><br><span class="line">        getimagesize( $uploaded_tmp ) ) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Can we move the file to the upload folder?</span></span><br><span class="line">        <span class="keyword">if</span>( !move_uploaded_file( $uploaded_tmp, $target_path ) ) &#123;</span><br><span class="line">            <span class="comment">// No</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;Your image was not uploaded.&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// Yes!</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;<span class="subst">&#123;$target_path&#125;</span> succesfully uploaded!&lt;/pre&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Invalid file</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;Your image was not uploaded. We can only accept JPEG or PNG images.&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>查了一下</p>
<p>strtolower函数将字符串转化为了小写，用来验证文件的后缀名</p>
<p>gettimagesize函数检测文件是否为图片，同时检测长宽高</p>
<p>所以上传的必须是个图片，之前有听说过图片马，所以应该是利用图片马来进行解题</p>
<h2 id="Insecure-CAPTCHA-不安全的验证码"><a href="#Insecure-CAPTCHA-不安全的验证码" class="headerlink" title="Insecure CAPTCHA(不安全的验证码)"></a>Insecure CAPTCHA(不安全的验证码)</h2><h3 id="low-4"><a href="#low-4" class="headerlink" title="low"></a>low</h3><p>查看源代码，发现这个</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519185424.png"></p>
<p>所以服务器对密码的更改是通过检查Change、step参数来判断，所以只要包里有step=2和change就可以成功，然后我就进行改包</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519185457.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519185516.png"></p>
<h3 id="medium-4"><a href="#medium-4" class="headerlink" title="medium"></a>medium</h3><p>查看源码</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519194659.png"></p>
<p>对比于Low等级，多加了这个的验证</p>
<p>抓包改包，把passed_captcha改为ture</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519194706.png"></p>
<p><img src="https://ae01.alicdn.com/kf/U102635f5b138454ca1d714b2dcad1631u.jpg"></p>
<h3 id="high-4"><a href="#high-4" class="headerlink" title="high"></a>high</h3><p>还是需要研究源代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">// Check CAPTCHA from 3rd party</span></span><br><span class="line">   $resp = recaptcha_check_answer($_DVWA[ <span class="string">&#x27;recaptcha_private_key&#x27;</span> ],$_POST[<span class="string">&#x27;g-recaptcha-response&#x27;</span>]);</span><br><span class="line"><span class="keyword">if</span> ($resp||($_POST[ <span class="string">&#x27;g-recaptcha-response&#x27;</span> ]==<span class="string">&#x27;hidd3n_valu3&#x27;</span>&amp;&amp; $_SERVER[ <span class="string">&#x27;HTTP_USER_AGENT&#x27;</span> ] == <span class="string">&#x27;reCAPTCHA&#x27;</span>))&#123;</span><br><span class="line">   <span class="comment">// CAPTCHA was correct. Do both new passwords match?</span></span><br></pre></td></tr></table></figure>

<p>这段最重要，当$resp正确，或者当g-recaptcha-response=hidd3n_valu3且HTTP_USER_AGENT=reCAPTCHA的时候，可以认位验证码正确</p>
<p>$resp是无法控制的，那只能从g-recaptcha-response和HTTP_USER_AGENT上下手，抓包修改</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519191458.png"></p>
<p>success!!</p>
<h2 id="SQL-injection（sql注入"><a href="#SQL-injection（sql注入" class="headerlink" title="SQL injection（sql注入)"></a>SQL injection（sql注入)</h2><h3 id="low-5"><a href="#low-5" class="headerlink" title="low"></a>low</h3><p>知识点：为什么’or 1=1#这类为万能密码</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">name</span>,<span class="keyword">password</span> <span class="keyword">from</span> tbAdmin <span class="keyword">where</span> <span class="keyword">name</span> = <span class="string">&#x27;admin&#x27;</span> <span class="keyword">and</span> <span class="keyword">password</span> = <span class="string">&#x27;123456&#x27;</span></span><br><span class="line">//注入后</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">name</span>,<span class="keyword">password</span> <span class="keyword">from</span> tbAdmin <span class="keyword">where</span> <span class="keyword">name</span> =<span class="string">&#x27;&#x27;</span><span class="keyword">or</span> <span class="number">1</span>=<span class="number">1</span><span class="comment">#&#x27;and password = &#x27;123456&#x27;</span></span><br></pre></td></tr></table></figure>

<p>源码:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_REQUEST[ <span class="string">&#x27;Submit&#x27;</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $id = $_REQUEST[ <span class="string">&#x27;id&#x27;</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check database</span></span><br><span class="line">    $query  = <span class="string">&quot;SELECT first_name, last_name FROM users WHERE user_id = &#x27;<span class="subst">$id</span>&#x27;;&quot;</span>;</span><br><span class="line">    $result = mysql_query( $query ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">&#x27;&lt;pre&gt;&#x27;</span> . mysql_error() . <span class="string">&#x27;&lt;/pre&gt;&#x27;</span> );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get results</span></span><br><span class="line">    $num = mysql_numrows( $result );</span><br><span class="line">    $i   = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>( $i &lt; $num ) &#123;</span><br><span class="line">        <span class="comment">// Get values</span></span><br><span class="line">        $first = mysql_result( $result, $i, <span class="string">&quot;first_name&quot;</span> );</span><br><span class="line">        $last  = mysql_result( $result, $i, <span class="string">&quot;last_name&quot;</span> );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Feedback for end user</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;ID: <span class="subst">&#123;$id&#125;</span>&lt;br /&gt;First name: <span class="subst">&#123;$first&#125;</span>&lt;br /&gt;Surname: <span class="subst">&#123;$last&#125;</span>&lt;/pre&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Increase loop count</span></span><br><span class="line">        $i++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    mysql_close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这里用了id来直接传到表里，尝试着输入一个1，</p>
<p>然后又尝试了2，3，4，发现每个数字对应的用户名是不同的</p>
<p>于是写入’or 1=’1’#</p>
<h3 id="medium-5"><a href="#medium-5" class="headerlink" title="medium"></a>medium</h3><p>查看源码</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519194727.png"></p>
<p>注意到这里调用了mysqli_real_escape_string()函数来转义</p>
<ul>
<li>\x00</li>
<li>\n</li>
<li>\r</li>
<li>\</li>
<li>‘</li>
<li>“</li>
<li>\x1a</li>
</ul>
<p>那第一次写入的’or 1=1#就会被转义</p>
<p>通过抓包修改数据</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519194817.png"></p>
<p>id=1 or 1=1#&amp;Submit=Submit</p>
<p>数字型注入，不需要符号</p>
<p>猜测字段数，把id改为id=2 order by 1#成功</p>
<p>id=2 order by 2#成功</p>
<p>id=2 order by 3#失败</p>
<p>说明执行的SQL查询语句里面只有两个字段</p>
<p>再把id改为id=2 union select 1,2#来确定字段的顺序</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519194843.png"></p>
<p>这样就知道了1是first name,2是surname</p>
<p>开始查询数据库</p>
<p>id=2 union select 1,database()#</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519194847.png"></p>
<p>数据库名为dvwa</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519194854.png"></p>
<p>两个表，一个是users，一个是guestbook</p>
<p>本来以为到这里就可以了，查了一下csdn上面大佬的进一步行动，这里记录一下</p>
<p>获取表中的字段名，把id=1 union select 1,group_concat(column_name) from information_schema.columns where table_name=’users’#</p>
<p>但是因为单引号被过滤了，怎么办呢</p>
<p>用十六进制进行绕过</p>
<p>id=1 union select 1,group_concat(column_name) from information_schema.columns where table_name=0x7573657273 #</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519194905.png"></p>
<p>user表里面有八个字段分别是</p>
<p>user_id,firse_name,last_name,user,password,avatar,last_login,failed_login</p>
<h3 id="high-5"><a href="#high-5" class="headerlink" title="high"></a>high</h3><p>输入1‘ and ‘1’=’2’ #</p>
<p>无显示，报错，说明这是一个字符型的注入</p>
<p>1’ order by 2 #</p>
<p>字段数为2</p>
<p>1’ untion select 1,database() #</p>
<p>爆出数据库名</p>
<p>同样姿势——获取表名——获取数据库中的列——获取列中的字段，得到账户密码</p>
<h2 id="SQL-Injection-Blind"><a href="#SQL-Injection-Blind" class="headerlink" title="SQL Injection(Blind)"></a>SQL Injection(Blind)</h2><h3 id="low-6"><a href="#low-6" class="headerlink" title="low"></a>low</h3><p>盲注分为</p>
<ul>
<li>基于布尔的盲注</li>
<li>基于时间的盲注</li>
<li>基于报错的盲注</li>
</ul>
<p>先看源码</p>
<p>发现对id的输入没有任何过滤</p>
<p>前置知识：</p>
<p>is_null($var):检测变量是否为NULL</p>
<p>var允许传入任意参数，如果var是null则返回TRUE，否则返回FALSE</p>
<p>@mysqli_num_rows():</p>
<p>函数返回结果集中行的数量，前面加上了@，所以如果mysqli_num_rows()执行出错，那么也不会返回错误信息，而是返回0</p>
<p>注:此处的结果集必须是sql成功执行的，sql语句执行失败的错误返回信息不是结果集</p>
<p>substr(str,pos,len):SQL语句</p>
<p>在str中从pos开始的位置(起始位置为1),截取len个字符，类同于php里面的substr函数，区别在于这里的起始位置的参数为1</p>
<p>ord:SQL语句</p>
<p>负责将字符转换成ASCII码</p>
<p>mid(参数1，参数2，参数3):</p>
<p>在参数1的字符串中从参数2的指定的位置开始（起始位置为1），截取数量为参数3数值的字符串。和substr的用法一样知识substr的起始位置为0</p>
<p>limit:</p>
<p>limit m: 检索前m行数据，显示1-10行数据(m&gt;0)</p>
<p>limit(x,y): 检索从x+1行开始的y行数据，显示第x+1到第y行的数据</p>
<p>1.判断是否存在注入，注入是字符型还是数字型</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519195544.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519195549.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519195553.png"></p>
<p><img src="https://ae01.alicdn.com/kf/U3a61b5a746f74008829def3fc644d40fW.jpg"></p>
<p>从此处得知存在sql注入漏洞，且为字符型注入</p>
<p>如何判断是字符型注入还是数字型注入呢？</p>
<p>输入的参数为<strong>整型</strong>时：</p>
<p>当输入1 and 1=1时，后台会执行</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> &lt;表名&gt; <span class="keyword">where</span> <span class="keyword">id</span> = <span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span>=<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>没有语法错误而且逻辑判断正确，所以返回正常</p>
<p>当输入1 and 1=2时，后台会执行</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> &lt;表名&gt; <span class="keyword">where</span> <span class="keyword">id</span> = <span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span>=<span class="number">2</span></span><br></pre></td></tr></table></figure>

<p>没有语法错误但是逻辑判断为假，所以返回错误，那可以说明此处为数字型注入</p>
<p>这时候如果是字符型注入的话，输入以上语句应该出现如下情况</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> &lt;表名&gt; <span class="keyword">where</span> <span class="keyword">id</span> = <span class="string">&#x27;x and 1=1&#x27;</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> &lt;表名&gt; <span class="keyword">where</span> <span class="keyword">id</span> = <span class="string">&#x27;x and 1=2&#x27;</span></span><br></pre></td></tr></table></figure>

<p>查询语句把and语句转换为了字符串，没有and的逻辑判断，所以没有报错</p>
<p>由此得知此处为字符串注入</p>
<p>输入的参数为<strong>字符型</strong>时：</p>
<p>输入x’ and ‘1’=’1，后台会执行</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> &lt;表名&gt; <span class="keyword">where</span> <span class="keyword">id</span> = <span class="string">&#x27;x&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;1&#x27;</span>=<span class="string">&#x27;1&#x27;</span></span><br></pre></td></tr></table></figure>

<p>语法正确，逻辑判断正确，所以返回正确</p>
<p>输入x’ and ‘1’=’2时，后台会执行</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> &lt;表名&gt; <span class="keyword">where</span> <span class="keyword">id</span> = <span class="string">&#x27;x&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;1&#x27;</span>=<span class="string">&#x27;2&#x27;</span></span><br></pre></td></tr></table></figure>

<p>语法正确，但是逻辑判断错误，所以返回错误，sql注入为字符型注入</p>
<p>2.猜当前的数据库名称</p>
<p>首先要<strong>猜解数据库名的长度</strong>，再逐个猜解字符</p>
<p>输入1’ and length(database())=1#开始一个个试错</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519195616.png"></p>
<p>所以数据库名的长度为4</p>
<p>接着猜解第一个字符</p>
<p>输入1’ and ascii(substr(database(),1,1))&gt;97 #</p>
<p>显示存在，那么第一个字符大于小写a</p>
<p>输入1’ and ascii(mid(database(),1,1))&lt;122 #</p>
<p>显示存在，那么第一个字符小于z</p>
<p>然后开始二分法，不断缩小</p>
<p>到最后输入1’ and ascii(substr(database(),1,1))=100 #</p>
<p>显示存在，那么第一个字符就是d</p>
<p>同样方法猜解四个字母，得到数据库名为dvwa</p>
<p>3.猜数据库中的表名</p>
<p>先猜解数据库中表的数量</p>
<p>输入1’ and (select count(table_name) from information_schema.tables where table_schema=database())=1 #</p>
<p>显示不存在</p>
<p>改为1’ and (select count(table_name) from information_schema.tables where table_schema=database())=2 #</p>
<p>显示存在，则在dvwa库里一共有两个表，于是开始猜解第一个表的长度</p>
<p>输入1’ and length(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1))=1 #</p>
<p>一直尝试到第五个</p>
<p>输入1’ and length(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1))=5 #</p>
<p>显示存在，那么第一个表的长度就为5字符</p>
<p>同猜测数据库名，开始猜测表的第一个字符</p>
<p>输入1’ and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&lt;122 #</p>
<p>1’ and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;97 #</p>
<p>最后得到第一个表名为users</p>
<p>输入1’ and length(substr((select table_name from information_schema.tables where table_schema=database() limit 1,2),1))=9 #</p>
<p>得到第二个表名长度为9字符</p>
<p>1’ and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 1,2),1,1))=103 #</p>
<p>1’ and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 1,2),2,1))=117 #</p>
<p>最后得到第二个表名为guestsbook</p>
<p>4.猜表中的字段名</p>
<p>首先猜解表中字段的数量</p>
<p>输入1’ and (select count(column_name) from information_schema.columns where table_name=’users’)=11 #</p>
<p>显示存在，开始猜解第一个字段的长度</p>
<p>输入1’ and length(substr((select column_name from information_schema.columns where table_name=’users’ limit 0,1),1))=4 #</p>
<p>则users的表中第一个字段的长度为4</p>
<p>输入1’ and ascii(substr((select column_name from information_schema.columns where table_name=’users’ limit 0,1),1,1))&gt;97 #</p>
<p>猜解第一个字段的第一个字母</p>
<p>理论上可以接下去不断猜解，我猜解不下去了，于是参考了其他dalao的wp，十一个字段分别是</p>
<p>first_name</p>
<p>ast_name</p>
<p>user</p>
<p>password</p>
<p>avatar</p>
<p>last_login</p>
<p>failed_login</p>
<p>USER</p>
<p>CURRENT_CONNECTIONS</p>
<p>TOTAL_CONNECTIONS</p>
<p>大佬还提供了经验猜解字段名</p>
<p>1’ and (select count(*) from information_schema.columns where table_schema=database() and table_name=’users’ and column_name=’password’)=1 #<br>返回存在，说明存在dvwa的users表中有名称为password的字段</p>
<p>5.获取表中的字段值</p>
<p>1’ and length(substr((select user from users limit 0,1),1))=5 #</p>
<p>user字段中第一个数据的长度为5</p>
<p>开始猜解这个数据的名称</p>
<p>输入1’ and ascii(substr((select user from users limit 0,1),1,1))=97 #</p>
<p>第一个字母为a</p>
<p>最后得到名字为admin</p>
<p>6.验证字段值的有效性</p>
<p>7.获取数据库的其他信息</p>
<p>同理可得password</p>
<h3 id="medium-6"><a href="#medium-6" class="headerlink" title="medium"></a>medium</h3><p>查看源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_POST[ <span class="string">&#x27;Submit&#x27;</span> ]  ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $id = $_POST[ <span class="string">&#x27;id&#x27;</span> ];</span><br><span class="line">    $id = ((<span class="keyword">isset</span>($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; is_object($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>])) ? mysqli_real_escape_string($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>],  $id ) : ((trigger_error(<span class="string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="string">&quot;&quot;</span> : <span class="string">&quot;&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check database</span></span><br><span class="line">    $getid  = <span class="string">&quot;SELECT first_name, last_name FROM users WHERE user_id = <span class="subst">$id</span>;&quot;</span>;</span><br><span class="line">    $result = mysqli_query($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>],  $getid ); <span class="comment">// Removed &#x27;or die&#x27; to suppress mysql errors</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get results</span></span><br><span class="line">    $num = @mysqli_num_rows( $result ); <span class="comment">// The &#x27;@&#x27; character suppresses errors</span></span><br><span class="line">    <span class="keyword">if</span>( $num &gt; <span class="number">0</span> ) &#123;</span><br><span class="line">        <span class="comment">// Feedback for end user</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;User ID exists in the database.&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Feedback for end user</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;User ID is MISSING from the database.&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//mysql_close();</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>从源码可以看出来这是数字型注入，使用了mysqli_real_escape_string转义NULL(ASCCI 0)、\n、\r、\、’、”和control-z</p>
<p>所以通过抓包来修改id并构造sql语句进行注入</p>
<p>sql中if函数的用法：</p>
<p>if(a,b,c)</p>
<p>a的值为true,则返回值为b。a的值为false，则返回值为c</p>
<p>使用的方法：对于if(判断条件，sleep(n),1)函数而言，若判断条件为真，则执行sleep(n)函数，达到在正常响应时间的基础上再延迟相应n秒的效果，若判断条件为假，则返回设置的1，此时不会执行sleep(n)函数</p>
<p>抓包，发送到Repeater,修改id的值</p>
<p>id=1 and if(length(database())=4,sleep(6),1) #</p>
<p>数据库长度为4</p>
<p>id=1 and if(ascii(substr(database(),1,1))=100,sleep(6),1) #</p>
<p>首字母为d，多次尝试后得到数据库名为dvwa</p>
<p>id=1 and if((select count(table_name) from information_schema.tables where table_schema=database())=2,sleep(6),1) #</p>
<p>dvwa数据库中有2张表</p>
<p>id=1 and if(length(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1))=5,sleep(6),1) #</p>
<p>第一个表名的长度是5</p>
<p>1 and if(ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))=117,sleep(6),1) #</p>
<p>只需要修改limit的参数就可以了</p>
<p>得出表名为users</p>
<p>1 and if((select count(column_name) from information_schema.columns where table_schema=database() and table_name=0x7573657273)=8,sleep(6),1) #</p>
<p>这里用十六进制绕过了users过滤</p>
<p>接下去操纵同low，可以猜解出user和password</p>
<h3 id="high-6"><a href="#high-6" class="headerlink" title="high"></a>high</h3><p>看到源码里面当sql查询为空的时候，执行了sleep(seconds)函数，这样就不能进行基于时间的盲注了，只能利用基于布尔的注入，在bp里面抓包，发到Repeater，也能实现目的</p>
<h2 id="Weak-Session-IDs"><a href="#Weak-Session-IDs" class="headerlink" title="Weak Session IDs"></a>Weak Session IDs</h2><h3 id="low-7"><a href="#low-7" class="headerlink" title="low"></a>low</h3><p>在用户登录之后，服务器就会创建一个会话(session)，叫做会话控制，接着访问页面的时候就不用登录，只需要带着session去访问，sessionID作为特定用户访问站点所需要的唯一内容，如果能够获取该sessionID，则攻击者可以轻易获取访问权限，无需登录直接进入特定用户界面，进而进行其他操作</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519195056.png"></p>
<p>发现多点几次，dvwaSession的次数均+1</p>
<p>则Cookie:dvwaSession=21;security=low;PHPSESSID=4nkebg5u1fh34lni8oqtqs2ach</p>
<p>然后用burpsuit抓包，把原来的数据包发给Reapeater模块，手动将dvwaSession加一，发现可以，网页正常响应</p>
<p>这里因为中间多点了几次，所以放个35的图</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519195100.png"></p>
<h3 id="medium-7"><a href="#medium-7" class="headerlink" title="medium"></a>medium</h3><p>查看源码</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519195121.png"></p>
<p>这里如果是POST方法的话，则设置利用时间戳生成Session</p>
<p><img src="https://ae01.alicdn.com/kf/Ubef6d786243941318baf03b4b2f9fd29A.jpg"></p>
<p>抓包得到dvwaSession=1613658446-&gt;2021-02-18 22:27:26</p>
<p>时间戳在线转换，可以得到用户当前的访问时间</p>
<h3 id="high-7"><a href="#high-7" class="headerlink" title="high"></a>high</h3><p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519195213.png"></p>
<p>和low是一样的，只是加了一个md5加密</p>
<h2 id="XSS-DOM"><a href="#XSS-DOM" class="headerlink" title="XSS(DOM)"></a>XSS(DOM)</h2><h3 id="low-8"><a href="#low-8" class="headerlink" title="low"></a>low</h3><p>全称：Document Object Model，使用DOM可以使程序和脚本能够动态访问和更新文档的内容、结构及样式。DOM型XSS是一种特殊的反射型XSS，它是基于DOM文档对象模型的一种漏洞。基于DOM型的XSS漏洞不需要与服务器交互，它发生在客户端处理数据阶段</p>
<h3 id="medium-8"><a href="#medium-8" class="headerlink" title="medium"></a>medium</h3><p>查看源码</p>
<p><img src="https://ae01.alicdn.com/kf/U02457671beab4017b275a794797da3d24.jpg"></p>
<p>可以看到过滤了&lt;script</p>
<p>查找资料得知可以使用img标签</p>
<p>写入&lt;img src=1 onerror=alert(‘haha’)&gt;，发现没有弹窗</p>
<p>onerror=”function()”当视频的媒体数据加载期间发生错误时执行</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519191923.png"></p>
<p>语句被插到了value值里面，但是没插入到option标签的值中，所以要闭合前面的option标签</p>
<p>&lt;/option&gt;&lt;img src=1 onerror=alert(‘haha’)&gt;</p>
<p>还是不行</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519191927.png"></p>
<p>得再闭合前面的select标签</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519191824.png"></p>
<p>成功弹窗</p>
<h3 id="high-8"><a href="#high-8" class="headerlink" title="high"></a>high</h3><p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519195221.png"></p>
<p>说明必须要有French这一类的值，其实可以写成=English#+语句来攻击</p>
<p>直接在url栏构造?default=English#&lt;script&gt;alert(1)&lt;/script&gt;</p>
<p>成功弹</p>
<h2 id="XSS-Reflected"><a href="#XSS-Reflected" class="headerlink" title="XSS(Reflected)"></a>XSS(Reflected)</h2><h3 id="low-9"><a href="#low-9" class="headerlink" title="low"></a>low</h3><p>查看源码</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519195858.png"></p>
<p>把name参数的值改成js标签</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519195922.png"></p>
<p>成功出现弹窗</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519195928.png"></p>
<h3 id="medium-9"><a href="#medium-9" class="headerlink" title="medium"></a>medium</h3><p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519200505.png"></p>
<p>查阅str_replace(a,b,c)函数是区分大小写的，那么可以直接大小写绕过</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519200512.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519200518.png"></p>
<h3 id="high-9"><a href="#high-9" class="headerlink" title="high"></a>high</h3><p>可以用img标签进行绕过</p>
<p>&lt;img src=1 onerror=alert(‘wuhu’)&gt;</p>
<p><img src="https://ae01.alicdn.com/kf/U8d430c308eb242cb83a69dffbf2c90b3Y.jpg"></p>
<h2 id="XSS-Stored"><a href="#XSS-Stored" class="headerlink" title="XSS(Stored)"></a>XSS(Stored)</h2><h3 id="low-10"><a href="#low-10" class="headerlink" title="low"></a>low</h3><p>储存型xss</p>
<p><img src="https://ae01.alicdn.com/kf/Uc854c3669b544f75bc0446f4d0994382p.jpg"></p>
<p>也在message处写下js代码，&lt;script&gt;alert(“xss”)&lt;script&gt;</p>
<p>==！找不到攻击成功的图了，就勉强看看吧==</p>
<p>刷新，换其他name尝试留言，每次都会出现xss弹窗</p>
<h3 id="medium-10"><a href="#medium-10" class="headerlink" title="medium"></a>medium</h3><p>源码好长，我写一些我查了之后的函数</p>
<p>addslashes():返回在预定义字符之前添加反斜杠的字符串，有’、”、\、NULL</p>
<p>strip_tags():去除字符串中的html,xml,php的标签</p>
<p>htmlspecialchars():把&lt;、&gt;、&amp;、’’、””转换为了HTML实体，防止浏览器把这些字符作为HTML元素</p>
<p>比如和low的时候一样输入的话，那就会把&lt;script&gt;标签去除，把’转义成\</p>
<p>源代码同时限制了name的输入长度为10，这激发了我的想法，用bp抓包，更改该name的值，这样就可以避免输入长度的限制，同时一下子绕过所有转义</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519200813.png"></p>
<p>没有弹窗…..</p>
<p>考虑了一下，想到name一栏是text发送，所以我把&lt;SCRIPT&gt;alert(‘hack’)&lt;/SCRIPT&gt;进行了url编码</p>
<p>%3cSCRIPT%3ealert(%27alielie%27)%3c%2fSCRIPT%3e</p>
<p>这次把这个当名字攻击</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519190926.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519190930.png"></p>
<h3 id="high-10"><a href="#high-10" class="headerlink" title="high"></a>high</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$name = preg_replace( <span class="string">&#x27;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i&#x27;</span>, <span class="string">&#x27;&#x27;</span>, $name );</span><br><span class="line">    $name = ((<span class="keyword">isset</span>($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; is_object($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>])) ? mysqli_real_escape_string($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>],  $name ) : ((trigger_error(<span class="string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="string">&quot;&quot;</span> : <span class="string">&quot;&quot;</span>)); </span><br></pre></td></tr></table></figure>

<p>看不懂，开始百度，说对name进行了正则表达式过滤，过滤了script标签</p>
<p>那可以使用&lt;img src=# onerror=’alert(ahhh)’&gt;来进行攻击同XSS(DOM)-medium一样</p>
<p>抓包修改name=%3cimg+src%3d1+alert(%27alielielie%27)%3e</p>
<p>成功弹窗</p>
<h2 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h2><h3 id="low-11"><a href="#low-11" class="headerlink" title="low"></a>low</h3><p>先看源码</p>
<p>发现这部分，提交的token都是讲ChangeMe进行加密。和写进去的success没有关系，这段代码可以知道是对success先进行rot13加密，再进行md5加密，于是使用在线工具</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519192215.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519192218.png"></p>
<p>得到taken和success对应的值，再使用brupsuit改包</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519192226.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519192231.png"></p>
<h3 id="medium-11"><a href="#medium-11" class="headerlink" title="medium"></a>medium</h3><p>整理了一下js的代码</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519192127.png"></p>
<p>do_elsesomething()函数生成token,将其传入参数e，前端表单输入的phrase值以及“XX”字符串进行拼接，再调用do_something()函数进行字符串翻转处理</p>
<p>于是按F12</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519192130.png"></p>
<p>找到token的值，把它修改为翻转的success</p>
<p>输入success</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519192134.png"></p>
<p>提交</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519192101.png"></p>
<h3 id="high-11"><a href="#high-11" class="headerlink" title="high"></a>high</h3><p>打开JS代码</p>
<p><img src="https://cdn.jsdelivr.net/gh/jam119/jam119.github.io/img/20210519192037.png"></p>
<p>好吧，下次再做</p>
<!--这篇文章很多次都重新抠图了，所以可能会出现图文不符....可以单独联系我哈-->

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">海生</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://example.com/2021/03/09/DVWA%E5%81%9A%E9%A2%98%E7%AC%94%E8%AE%B0/">http://example.com/2021/03/09/DVWA%E5%81%9A%E9%A2%98%E7%AC%94%E8%AE%B0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF-notes/">CTF notes</a></div><div class="post_share"><div class="social-share" data-image="https://ftp.bmp.ovh/imgs/2021/03/cbc47d4371fd43c6.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> Donate<div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://ae01.alicdn.com/kf/U107901cee6a340c4be04bb85209cd57cG.jpg" target="_blank"><img class="post-qr-code-img" src="https://ae01.alicdn.com/kf/U107901cee6a340c4be04bb85209cd57cG.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="https://ae01.alicdn.com/kf/U9fae70af3abb4ddd8a48dc25baeb2e38V.jpg" target="_blank"><img class="post-qr-code-img" src="https://ae01.alicdn.com/kf/U9fae70af3abb4ddd8a48dc25baeb2e38V.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/04/20/%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0/"><img class="prev-cover" src="/img/104.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">学习日记</div></div></a></div><div class="next-post pull-right"><a href="/2021/02/07/MySQL/"><img class="next-cover" src="/img/102.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">MySQL</div></div></a></div></nav></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/%E5%A4%B4%E5%83%8F1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">海生</div><div class="author-info__description">A student,also a ctf rookie</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">6</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">2</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div></div><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>Announcement</span></div><div class="announcement_content">请你喝一杯蜂蜜云普茶</div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="card-content"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#DVWA-wp"><span class="toc-number">1.</span> <span class="toc-text">DVWA-wp</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Brute-Force"><span class="toc-number">1.1.</span> <span class="toc-text">Brute Force</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#low"><span class="toc-number">1.1.1.</span> <span class="toc-text">low</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#medium"><span class="toc-number">1.1.2.</span> <span class="toc-text">medium</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#high"><span class="toc-number">1.1.3.</span> <span class="toc-text">high</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Command-Injection-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E"><span class="toc-number">1.2.</span> <span class="toc-text">Command Injection(命令执行漏洞)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#low-1"><span class="toc-number">1.2.1.</span> <span class="toc-text">low</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#medium-1"><span class="toc-number">1.2.2.</span> <span class="toc-text">medium</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#high-1"><span class="toc-number">1.2.3.</span> <span class="toc-text">high</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CSRF%EF%BC%88%E8%B7%A8%E7%AB%99%E7%82%B9%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%EF%BC%89"><span class="toc-number">1.3.</span> <span class="toc-text">CSRF（跨站点请求伪造）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#low-2"><span class="toc-number">1.3.1.</span> <span class="toc-text">low</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#medium-2"><span class="toc-number">1.3.2.</span> <span class="toc-text">medium</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#high-2"><span class="toc-number">1.3.3.</span> <span class="toc-text">high</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#File-Inclusion-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="toc-number">1.4.</span> <span class="toc-text">File Inclusion(文件包含)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#File-Upload-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-number">1.5.</span> <span class="toc-text">File Upload(文件上传)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#low-3"><span class="toc-number">1.5.1.</span> <span class="toc-text">low</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#medium-3"><span class="toc-number">1.5.2.</span> <span class="toc-text">medium</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#high-3"><span class="toc-number">1.5.3.</span> <span class="toc-text">high</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Insecure-CAPTCHA-%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E9%AA%8C%E8%AF%81%E7%A0%81"><span class="toc-number">1.6.</span> <span class="toc-text">Insecure CAPTCHA(不安全的验证码)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#low-4"><span class="toc-number">1.6.1.</span> <span class="toc-text">low</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#medium-4"><span class="toc-number">1.6.2.</span> <span class="toc-text">medium</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#high-4"><span class="toc-number">1.6.3.</span> <span class="toc-text">high</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL-injection%EF%BC%88sql%E6%B3%A8%E5%85%A5"><span class="toc-number">1.7.</span> <span class="toc-text">SQL injection（sql注入)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#low-5"><span class="toc-number">1.7.1.</span> <span class="toc-text">low</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#medium-5"><span class="toc-number">1.7.2.</span> <span class="toc-text">medium</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#high-5"><span class="toc-number">1.7.3.</span> <span class="toc-text">high</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL-Injection-Blind"><span class="toc-number">1.8.</span> <span class="toc-text">SQL Injection(Blind)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#low-6"><span class="toc-number">1.8.1.</span> <span class="toc-text">low</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#medium-6"><span class="toc-number">1.8.2.</span> <span class="toc-text">medium</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#high-6"><span class="toc-number">1.8.3.</span> <span class="toc-text">high</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Weak-Session-IDs"><span class="toc-number">1.9.</span> <span class="toc-text">Weak Session IDs</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#low-7"><span class="toc-number">1.9.1.</span> <span class="toc-text">low</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#medium-7"><span class="toc-number">1.9.2.</span> <span class="toc-text">medium</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#high-7"><span class="toc-number">1.9.3.</span> <span class="toc-text">high</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XSS-DOM"><span class="toc-number">1.10.</span> <span class="toc-text">XSS(DOM)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#low-8"><span class="toc-number">1.10.1.</span> <span class="toc-text">low</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#medium-8"><span class="toc-number">1.10.2.</span> <span class="toc-text">medium</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#high-8"><span class="toc-number">1.10.3.</span> <span class="toc-text">high</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XSS-Reflected"><span class="toc-number">1.11.</span> <span class="toc-text">XSS(Reflected)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#low-9"><span class="toc-number">1.11.1.</span> <span class="toc-text">low</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#medium-9"><span class="toc-number">1.11.2.</span> <span class="toc-text">medium</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#high-9"><span class="toc-number">1.11.3.</span> <span class="toc-text">high</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XSS-Stored"><span class="toc-number">1.12.</span> <span class="toc-text">XSS(Stored)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#low-10"><span class="toc-number">1.12.1.</span> <span class="toc-text">low</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#medium-10"><span class="toc-number">1.12.2.</span> <span class="toc-text">medium</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#high-10"><span class="toc-number">1.12.3.</span> <span class="toc-text">high</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JavaScript"><span class="toc-number">1.13.</span> <span class="toc-text">JavaScript</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#low-11"><span class="toc-number">1.13.1.</span> <span class="toc-text">low</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#medium-11"><span class="toc-number">1.13.2.</span> <span class="toc-text">medium</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#high-11"><span class="toc-number">1.13.3.</span> <span class="toc-text">high</span></a></li></ol></li></ol></li></ol></div></div></div><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/04/20/%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0/" title="学习日记"><img src="/img/104.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="学习日记"/></a><div class="content"><a class="title" href="/2021/04/20/%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0/" title="学习日记">学习日记</a><time datetime="2021-04-20T14:20:39.845Z" title="Created 2021-04-20 22:20:39">2021-04-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/03/09/DVWA%E5%81%9A%E9%A2%98%E7%AC%94%E8%AE%B0/" title="DVWA-WP"><img src="https://ftp.bmp.ovh/imgs/2021/03/cbc47d4371fd43c6.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="DVWA-WP"/></a><div class="content"><a class="title" href="/2021/03/09/DVWA%E5%81%9A%E9%A2%98%E7%AC%94%E8%AE%B0/" title="DVWA-WP">DVWA-WP</a><time datetime="2021-03-09T13:45:05.448Z" title="Created 2021-03-09 21:45:05">2021-03-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/02/07/MySQL/" title="MySQL"><img src="/img/102.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MySQL"/></a><div class="content"><a class="title" href="/2021/02/07/MySQL/" title="MySQL">MySQL</a><time datetime="2021-02-07T13:52:18.258Z" title="Created 2021-02-07 21:52:18">2021-02-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/01/26/PHP/" title="PHP学习"><img src="/img/100.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="PHP学习"/></a><div class="content"><a class="title" href="/2021/01/26/PHP/" title="PHP学习">PHP学习</a><time datetime="2021-01-26T14:17:56.268Z" title="Created 2021-01-26 22:17:56">2021-01-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/11/19/%E7%AC%AC%E4%B8%80%E4%B8%AA%E8%B5%B7%E6%AD%A5/" title="第一个起步"><img src="/img/article2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="第一个起步"/></a><div class="content"><a class="title" href="/2020/11/19/%E7%AC%AC%E4%B8%80%E4%B8%AA%E8%B5%B7%E6%AD%A5/" title="第一个起步">第一个起步</a><time datetime="2020-11-19T06:52:49.000Z" title="Created 2020-11-19 14:52:49">2020-11-19</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By 海生</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><div class="js-pjax"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><canvas class="fireworks" mobile="true"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="true"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script></div></body></html>